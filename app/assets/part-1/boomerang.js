if("performance"in window&&window.performance&&typeof window.performance.mark==="function"&&!window.BOOMR_no_mark){window.performance.mark("boomr:startup")}BOOMR_start=new Date().getTime();function BOOMR_check_doc_domain(domain){var test;if("performance"in window&&window.performance&&typeof window.performance.mark==="function"&&!window.BOOMR_no_mark){window.performance.mark("boomr:check_doc_domain")}if(!window){return}if(!domain){if(window.parent===window||!document.getElementById("boomr-if-as")){return;}if(window.BOOMR&&BOOMR.boomerang_frame&&BOOMR.window){try{if(BOOMR.boomerang_frame.document.domain!==BOOMR.window.document.domain){BOOMR.boomerang_frame.document.domain=BOOMR.window.document.domain}}catch(err){if(!BOOMR.isCrossOriginError(err)){BOOMR.addError(err,"BOOMR_check_doc_domain.domainFix")}}}domain=document.domain}if(!domain||domain.indexOf(".")===-1){return;}if(!window.parent){return}try{test=window.parent.document;return;}catch(err){try{document.domain=domain}catch(err2){return}}try{test=window.parent.document;return;}catch(err){domain=domain.replace(/^[\w\-]+\./,"")}BOOMR_check_doc_domain(domain)}BOOMR_check_doc_domain();(function(w){var impl,boomr,d,createCustomEvent,dispatchEvent,visibilityState,visibilityChange,orig_w=w;if(w.parent!==w&&document.getElementById("boomr-if-as")&&document.getElementById("boomr-if-as").nodeName.toLowerCase()==="script"){w=w.parent}d=w.document;if(!w.BOOMR){w.BOOMR={}}BOOMR=w.BOOMR;if(BOOMR.version){return}BOOMR.version="%boomerang_version%";BOOMR.window=w;BOOMR.boomerang_frame=orig_w;if(!BOOMR.plugins){BOOMR.plugins={}}(function(){try{if(new w.CustomEvent("CustomEvent")!==undefined){createCustomEvent=function(e_name,params){return new w.CustomEvent(e_name,params)}}}catch(ignore){}try{if(!createCustomEvent&&d.createEvent&&d.createEvent("CustomEvent")){createCustomEvent=function(e_name,params){var evt=d.createEvent("CustomEvent");params=params||{cancelable:false,bubbles:false};evt.initCustomEvent(e_name,params.bubbles,params.cancelable,params.detail);return evt}}}catch(ignore){}if(!createCustomEvent&&d.createEventObject){createCustomEvent=function(e_name,params){var evt=d.createEventObject();evt.type=evt.propertyName=e_name;evt.detail=params.detail;return evt}}if(!createCustomEvent){createCustomEvent=function(){return undefined}}}());dispatchEvent=function(e_name,e_data,async){var ev=createCustomEvent(e_name,{"detail":e_data});if(!ev){return}function dispatch(){try{if(d.dispatchEvent){d.dispatchEvent(ev)}else if(d.fireEvent){d.fireEvent("onpropertychange",ev)}}catch(e){BOOMR.debug("Error when dispatching "+e_name)}}if(async){BOOMR.setImmediate(dispatch)}else{dispatch()}};if(typeof d.hidden!=="undefined"){visibilityState="visibilityState";visibilityChange="visibilitychange"}else if(typeof d.mozHidden!=="undefined"){visibilityState="mozVisibilityState";visibilityChange="mozvisibilitychange"}else if(typeof d.msHidden!=="undefined"){visibilityState="msVisibilityState";visibilityChange="msvisibilitychange"}else if(typeof d.webkitHidden!=="undefined"){visibilityState="webkitVisibilityState";visibilityChange="webkitvisibilitychange"}impl={beacon_url:"",beacon_url_force_https:true,beacon_urls_allowed:[],beacon_type:"AUTO",beacon_auth_key:"Authorization",beacon_auth_token:undefined,beacon_with_credentials:false,beacon_disable_sendbeacon:false,site_domain:w.location.hostname.replace(/.*?([^.]+\.[^.]+)\.?$/,"$1").toLowerCase(),user_ip:"",autorun:true,hasSentPageLoadBeacon:false,r:undefined,events:{"page_ready":[],"page_unload":[],"before_unload":[],"dom_loaded":[],"visibility_changed":[],"prerender_to_visible":[],"before_beacon":[],"beacon":[],"page_load_beacon":[],"xhr_load":[],"click":[],"form_submit":[],"config":[],"xhr_init":[],"spa_init":[],"spa_navigation":[],"spa_cancel":[],"xhr_send":[],"xhr_error":[],"error":[],"netinfo":[],"rage_click":[]},public_events:{"before_beacon":"onBeforeBoomerangBeacon","beacon":"onBoomerangBeacon","onboomerangloaded":"onBoomerangLoaded"},translate_events:{"onbeacon":"beacon","onconfig":"config","onerror":"error","onxhrerror":"xhr_error"},unloadEventsCount:0,unloadEventCalled:0,listenerCallbacks:{},vars:{},singleBeaconVars:{},varPriority:{"-1":{},"1":{}},errors:{},disabled_plugins:{},localStorageSupported:false,LOCAL_STORAGE_PREFIX:"_boomr_",nativeOverwrites:[],xb_handler:function(type){return function(ev){var target;if(!ev){ev=w.event}if(ev.target){target=ev.target}else if(ev.srcElement){target=ev.srcElement}if(target.nodeType===3){target=target.parentNode}if(target&&target.nodeName&&target.nodeName.toUpperCase()==="OBJECT"&&target.type==="application/x-shockwave-flash"){return}impl.fireEvent(type,target)}},clearEvents:function(){var eventName;for(eventName in this.events){if(this.events.hasOwnProperty(eventName)){this.events[eventName]=[]}}},clearListeners:function(){var type,i;for(type in impl.listenerCallbacks){if(impl.listenerCallbacks.hasOwnProperty(type)){while(impl.listenerCallbacks[type].length){BOOMR.utils.removeListener(impl.listenerCallbacks[type][0].el,type,impl.listenerCallbacks[type][0].fn)}}}impl.listenerCallbacks={}},fireEvent:function(e_name,data){var i,handler,handlers,handlersLen;e_name=e_name.toLowerCase();BOOMR.utils.mark("fire_event");BOOMR.utils.mark("fire_event:"+e_name+":start");if(this.translate_events[e_name]){e_name=this.translate_events[e_name]}if(!this.events.hasOwnProperty(e_name)){return;}if(this.public_events.hasOwnProperty(e_name)){dispatchEvent(this.public_events[e_name],data)}handlers=this.events[e_name];if(e_name!=="before_beacon"&&e_name!=="beacon"){BOOMR.real_sendBeacon()}handlersLen=handlers.length;for(i=0;i<handlersLen;i+=1){try{handler=handlers[i];handler.fn.call(handler.scope,data,handler.cb_data)}catch(err){BOOMR.addError(err,"fireEvent."+e_name+"<"+i+">")}}for(i=0;i<handlersLen;i+=1){if(handlers[i].once){handlers.splice(i,1);handlersLen-=1;i-=1}}BOOMR.utils.mark("fire_event:"+e_name+":end");BOOMR.utils.measure("fire_event:"+e_name,"fire_event:"+e_name+":start","fire_event:"+e_name+":end");return;},spaNavigation:function(){impl.onloadfired=true},beaconUrlAllowed:function(url){if(!impl.beacon_urls_allowed||impl.beacon_urls_allowed.length===0){return true}for(var i=0;i<impl.beacon_urls_allowed.length;i+=1){var regEx=new RegExp(impl.beacon_urls_allowed[i]);if(regEx.exec(url)){return true}}return false},checkLocalStorageSupport:function(){var name=impl.LOCAL_STORAGE_PREFIX+"clss";impl.localStorageSupported=false;try{if(!w.JSON||!w.localStorage){return}w.localStorage.setItem(name,name);impl.localStorageSupported=(w.localStorage.getItem(name)===name);w.localStorage.removeItem(name)}catch(ignore){impl.localStorageSupported=false}},onFrameUnloaded:function(){var i,prop;BOOMR.isUnloaded=true;for(i=0;i<impl.nativeOverwrites.length;i+=1){prop=impl.nativeOverwrites[i];prop.obj[prop.functionName]=prop.origFn}impl.nativeOverwrites=[]}};boomr={t_start:BOOMR_start,t_end:undefined,url:"",config_url:null,loadedLate:false,beaconsSent:0,isUnloaded:false,beaconInQueue:false,constants:{BEACON_TYPE_SPAS:["spa","spa_hard"],MAX_GET_LENGTH:2000},session:{domain:impl.site_domain,ID:Math.random().toString(36).replace(/^0\./,""),start:undefined,length:0,enabled:true},utils:{hasPostMessageSupport:function(){if(!w.postMessage||typeof w.postMessage!=="function"&&typeof w.postMessage!=="object"){return false}return true},objectToString:function(o,separator,nest_level){var value=[],k;if(!o||typeof o!=="object"){return o}if(separator===undefined){separator="\n\t"}if(!nest_level){nest_level=0}if(BOOMR.utils.isArray(o)){for(k=0;k<o.length;k+=1){if(nest_level>0&&o[k]!==null&&typeof o[k]==="object"){value.push(this.objectToString(o[k],separator+(separator==="\n\t"?"\t":""),nest_level-1))}else{if(separator==="&"){value.push(encodeURIComponent(o[k]))}else{value.push(o[k])}}}separator=","}else{for(k in o){if(Object.prototype.hasOwnProperty.call(o,k)){if(nest_level>0&&o[k]!==null&&typeof o[k]==="object"){value.push(encodeURIComponent(k)+"="+this.objectToString(o[k],separator+(separator==="\n\t"?"\t":""),nest_level-1))}else{if(separator==="&"){value.push(encodeURIComponent(k)+"="+encodeURIComponent(o[k]))}else{value.push(k+"="+o[k])}}}}}return value.join(separator)},getCookie:function(name){if(!name){return null}BOOMR.utils.mark("get_cookie");name=" "+name+"=";var i,cookies;cookies=" "+d.cookie+";";if((i=cookies.indexOf(name))>=0){i+=name.length;cookies=cookies.substring(i,cookies.indexOf(";",i)).replace(/^"/,"").replace(/"$/,"");return cookies}},setCookie:function(name,subcookies,max_age){var value,nameval,savedval,c,exp;if(!name||!BOOMR.session.domain||typeof subcookies==="undefined"){BOOMR.debug("Invalid parameters or site domain: "+name+"/"+subcookies+"/"+BOOMR.session.domain);BOOMR.addVar("nocookie",1);return false}BOOMR.utils.mark("set_cookie");value=this.objectToString(subcookies,"&");nameval=name+"=\""+value+"\"";if(nameval.length<500){c=[nameval,"path=/","domain="+BOOMR.session.domain];if(typeof max_age==="number"){exp=new Date();exp.setTime(exp.getTime()+max_age*1000);exp=exp.toGMTString();c.push("expires="+exp)}d.cookie=c.join("; ");savedval=this.getCookie(name);if(value===savedval||(typeof savedval==="undefined"&&typeof max_age==="number"&&max_age<=0)){return true}BOOMR.warn("Saved cookie value doesn't match what we tried to set:\n"+value+"\n"+savedval)}else{BOOMR.warn("Cookie too long: "+nameval.length+" "+nameval)}BOOMR.addVar("nocookie",1);return false},getSubCookies:function(cookie){var cookies_a,i,l,kv,gotcookies=false,cookies={};if(!cookie){return null}if(typeof cookie!=="string"){BOOMR.debug("TypeError: cookie is not a string: "+typeof cookie);return null}cookies_a=cookie.split("&");for(i=0,l=cookies_a.length;i<l;i+=1){kv=cookies_a[i].split("=");if(kv[0]){kv.push("");cookies[decodeURIComponent(kv[0])]=decodeURIComponent(kv[1]);gotcookies=true}}return gotcookies?cookies:null},removeCookie:function(name){return this.setCookie(name,{},-86400)},getLocalStorage:function(name){var value,data;if(!name||!impl.localStorageSupported){return null}BOOMR.utils.mark("get_local_storage");try{value=w.localStorage.getItem(impl.LOCAL_STORAGE_PREFIX+name);if(value===null){return undefined}data=w.JSON.parse(value)}catch(e){BOOMR.warn(e);return null}if(!data||typeof data.items!=="object"){this.removeLocalStorage(name);return null}if(typeof data.expires==="number"){if(BOOMR.now()>=data.expires){this.removeLocalStorage(name);return undefined}}return data.items},setLocalStorage:function(name,items,max_age){var data,value,savedval;if(!name||!impl.localStorageSupported||typeof items!=="object"){return false}BOOMR.utils.mark("set_local_storage");data={"items":items};if(typeof max_age==="number"){data.expires=BOOMR.now()+(max_age*1000)}value=w.JSON.stringify(data);if(value.length<50000){try{w.localStorage.setItem(impl.LOCAL_STORAGE_PREFIX+name,value);savedval=w.localStorage.getItem(impl.LOCAL_STORAGE_PREFIX+name);if(value===savedval){return true}}catch(ignore){}BOOMR.warn("Saved storage value doesn't match what we tried to set:\n"+value+"\n"+savedval)}else{BOOMR.warn("Storage items too large: "+value.length+" "+value)}return false},removeLocalStorage:function(name){if(!name||!impl.localStorageSupported){return false}try{w.localStorage.removeItem(impl.LOCAL_STORAGE_PREFIX+name);return true}catch(ignore){}return false},cleanupURL:function(url,urlLimit){if(!url||BOOMR.utils.isArray(url)){return ""}if(impl.strip_query_string){url=url.replace(/\?.*/,"?qs-redacted")}if(typeof urlLimit!=="undefined"&&url&&url.length>urlLimit){var qsStart=url.indexOf("?");if(qsStart!==-1&&qsStart<urlLimit){url=url.substr(0,qsStart)+"?..."}else{url=url.substr(0,urlLimit-3)+"..."}}return url},hashQueryString:function(url,stripHash){if(!url){return url}if(!url.match){BOOMR.addError("TypeError: Not a string","hashQueryString",typeof url);return ""}if(url.match(/^\/\//)){url=location.protocol+url}if(!url.match(/^(https?|file):/)){BOOMR.error("Passed in URL is invalid: "+url);return ""}if(stripHash){url=url.replace(/#.*/,"")}if(!BOOMR.utils.MD5){return url}return url.replace(/\?([^#]*)/,function(m0,m1){return "?"+(m1.length>10?BOOMR.utils.MD5(m1):m1)})},pluginConfig:function(o,config,plugin_name,properties){var i,props=0;if(!config||!config[plugin_name]){return false}for(i=0;i<properties.length;i+=1){if(config[plugin_name][properties[i]]!==undefined){o[properties[i]]=config[plugin_name][properties[i]];props+=1}}return(props>0)},arrayFilter:function(array,predicate){var result=[];if(!(this.isArray(array)||(array&&typeof array.length==="number"))||typeof predicate!=="function"){return result}if(typeof array.filter==="function"){result=array.filter(predicate)}else{var index=-1,length=array.length,value;while(++index<length){value=array[index];if(predicate(value,index,array)){result[result.length]=value}}}return result},arrayFind:function(array,predicate){if(!(this.isArray(array)||(array&&typeof array.length==="number"))||typeof predicate!=="function"){return undefined}if(typeof array.find==="function"){return array.find(predicate)}else{var index=-1,length=array.length,value;while(++index<length){value=array[index];if(predicate(value,index,array)){return value}}return undefined}},isMutationObserverSupported:function(){var ie11=(w&&w.navigator&&w.navigator.userAgent&&w.navigator.userAgent.match(/Trident.*rv[ :]*11\./));return(!ie11&&w&&w.MutationObserver&&typeof w.MutationObserver==="function")},addObserver:function(el,config,timeout,callback,callback_data,callback_ctx){var MO,zs,o={observer:null,timer:null};BOOMR.utils.mark("add_observer");if(!this.isMutationObserverSupported()||!callback||!el){return null}function done(mutations){var run_again=false;BOOMR.utils.mark("mutation_observer_callback");if(o.timer){clearTimeout(o.timer);o.timer=null}if(callback){run_again=callback.call(callback_ctx,mutations,callback_data);if(!run_again){callback=null}}if(!run_again&&o.observer){o.observer.disconnect();o.observer=null}if(typeof run_again==="number"&&run_again>0){o.timer=setTimeout(done,run_again)}}MO=w.MutationObserver;if(w.Zone&&typeof w.Zone.__symbol__==="function"){zs=w.Zone.__symbol__("MutationObserver");if(zs&&typeof zs==="string"&&w.hasOwnProperty(zs)&&typeof w[zs]==="function"){BOOMR.debug("Detected Zone.js, using native MutationObserver");MO=w[zs]}}o.observer=new MO(done);if(timeout){o.timer=setTimeout(done,o.timeout)}o.observer.observe(el,config);return o},addListener:function(el,type,fn,passive){var opts=false;BOOMR.utils.mark("add_listener");if(el.addEventListener){if(passive&&BOOMR.browser.supportsPassive()){opts={capture:false,passive:true}}el.addEventListener(type,fn,opts)}else if(el.attachEvent){el.attachEvent("on"+type,fn)}impl.listenerCallbacks[type]=impl.listenerCallbacks[type]||[];impl.listenerCallbacks[type].push({el:el,fn:fn})},removeListener:function(el,type,fn){var i;BOOMR.utils.mark("remove_listener");if(el.removeEventListener){el.removeEventListener(type,fn,false)}else if(el.detachEvent){el.detachEvent("on"+type,fn)}if(impl.listenerCallbacks.hasOwnProperty(type)){for(var i=0;i<impl.listenerCallbacks[type].length;i+=1){if(fn===impl.listenerCallbacks[type][i].fn&&el===impl.listenerCallbacks[type][i].el){impl.listenerCallbacks[type].splice(i,1);return}}}},isArray:function(ary){return Object.prototype.toString.call(ary)==="[object Array]"},inArray:function(val,ary){var i;if(typeof val==="undefined"||typeof ary==="undefined"||!ary.length){return false}for(i=0;i<ary.length;i+=1){if(ary[i]===val){return true}}return false},getQueryParamValue:function(param,url){var l,params,i,kv;if(!param){return null}if(typeof url==="string"){l=BOOMR.window.document.createElement("a");l.href=url}else if(typeof url==="object"&&typeof url.search==="string"){l=url}else{l=BOOMR.window.location}params=l.search.slice(1).split(/&/);for(i=0;i<params.length;i+=1){if(params[i]){kv=params[i].split("=");if(kv.length&&kv[0]===param){return kv.length>1?decodeURIComponent(kv.splice(1).join("=").replace(/\+/g," ")):""}}}return null},generateUUID:function(){return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0;var v=c==="x"?r:(r&0x3|0x8);return v.toString(16)})},generateId:function(chars){return "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".substr(0,chars||40).replace(/x/g,function(c){var c=(Math.random()||0.01).toString(36);if(c==="0"){return "0"}else{return c.substr(2,1)}})},serializeForUrl:function(value){if(BOOMR.utils.Compression&&BOOMR.utils.Compression.jsUrl){return BOOMR.utils.Compression.jsUrl(value)}if(window.JSON){return JSON.stringify(value)}BOOMR.debug("JSON is not supported");return ""},getMyURL:function(){var stack;var BOOMR_script=(document.currentScript||document.getElementById("boomr-if-as")||document.getElementById("boomr-scr-as"));if(BOOMR_script){return BOOMR_script.src}var scripts=document.getElementsByTagName("script"),i;for(i=scripts.length;i-=1;){if(scripts[i].readyState==="interactive"){return scripts[i].src}}try{throw new Error()}catch(e){if("stack"in e){stack=this.arrayFilter(e.stack.split(/\n/),function(l){return l.match(/https?:\/\//)});if(stack&&stack.length){return stack[0].replace(/.*(https?:\/\/.+?)(:\d+)+\D*$/m,"$1")}}}return ""},scroll:function(){var supportPageOffset=w.pageXOffset!==undefined;var isCSS1Compat=((w.document.compatMode||"")==="CSS1Compat");var ret={x:0,y:0};if(supportPageOffset){if(typeof w.pageXOffset==="function"){ret.x=w.pageXOffset();ret.y=w.pageYOffset()}else{ret.x=w.pageXOffset;ret.y=w.pageYOffset}}else if(isCSS1Compat){ret.x=w.document.documentElement.scrollLeft;ret.y=w.document.documentElement.scrollTop}else{ret.x=w.document.body.scrollLeft;ret.y=w.document.body.scrollTop}if(typeof ret.sx==="number"){ret.sx=Math.round(ret.sx)}if(typeof ret.sy==="number"){ret.sy=Math.round(ret.sy)}return ret},windowHeight:function(){return w.innerHeight||w.document.documentElement.clientHeight||w.document.body.clientHeight},windowWidth:function(){return w.innerWidth||w.document.documentElement.clientWidth||w.document.body.clientWidth},isNative:function(fn){return!!fn&&fn.toString&&!fn.hasOwnProperty("toString")&&/\[native code\]/.test(String(fn))},overwriteNative:function(obj,functionName,newFn){if(!obj||!newFn){return}if(BOOMR.boomerang_frame!==BOOMR.window){impl.nativeOverwrites.push({obj:obj,functionName:functionName,origFn:obj[functionName]})}obj[functionName]=newFn},isInteger:function(data){var isInt=Number.isInteger||function(value){return typeof value==="number"&&isFinite(value)&&Math.floor(value)===value};return isInt(data)},forEach:function(array,fn,thisArg){if(!BOOMR.utils.isArray(array)||typeof fn!=="function"){return}var length=array.length;for(var i=0;i<length;i+=1){if(array.hasOwnProperty(i)){fn.call(thisArg,array[i],i,array)}}},mark:function(name){var p=BOOMR.getPerformance();if(p&&typeof p.mark==="function"&&!BOOMR.window.BOOMR_no_mark){p.mark("boomr:"+name)}},measure:function(measureName,startMarkName,endMarkName){var p=BOOMR.getPerformance();if(p&&typeof p.measure==="function"&&!BOOMR.window.BOOMR_no_mark){p.measure("boomr:"+measureName,startMarkName?"boomr:"+startMarkName:undefined,endMarkName?"boomr:"+endMarkName:undefined)}}},browser:{results:{},supportsPassive:function(){if(typeof BOOMR.browser.results.supportsPassive==="undefined"){BOOMR.browser.results.supportsPassive=false;if(!Object.defineProperty){return false}try{var opts=Object.defineProperty({},"passive",{get:function(){BOOMR.browser.results.supportsPassive=true}});window.addEventListener("test",null,opts)}catch(e){}}return BOOMR.browser.results.supportsPassive}},init:function(config){var i,k,properties=["autorun","beacon_auth_key","beacon_auth_token","beacon_with_credentials","beacon_disable_sendbeacon","beacon_url","beacon_url_force_https","beacon_type","site_domain","strip_query_string","user_ip"];BOOMR.utils.mark("init");BOOMR_check_doc_domain();if(!config){config={}}if(config.log!==undefined){this.log=config.log}if(!this.log){this.log=function(){}}if(!this.pageId){this.pageId=BOOMR.utils.generateId(8);BOOMR.debug("Generated PageID: "+this.pageId)}if(config.primary&&impl.handlers_attached){return this}if(typeof config.site_domain==="string"){this.session.domain=config.site_domain}if(typeof config.autorun!=="undefined"){impl.autorun=config.autorun}BOOMR.utils.mark("init:plugins:start");for(k in this.plugins){if(this.plugins.hasOwnProperty(k)){if(config[k]&&config[k].hasOwnProperty("enabled")&&config[k].enabled===false){impl.disabled_plugins[k]=1;if(typeof this.plugins[k].disable==="function"){this.plugins[k].disable()}continue}if(impl.disabled_plugins[k]){if(!config[k]||!config[k].hasOwnProperty("enabled")||config[k].enabled!==true){continue}if(typeof this.plugins[k].enable==="function"){this.plugins[k].enable()}delete impl.disabled_plugins[k]}if(typeof this.plugins[k].init==="function"){try{BOOMR.utils.mark("init:plugins:"+k+":start");this.plugins[k].init(config);BOOMR.utils.mark("init:plugins:"+k+":end");BOOMR.utils.measure("init:plugins:"+k,"init:plugins:"+k+":start","init:plugins:"+k+":end");}catch(err){BOOMR.addError(err,k+".init")}}}}BOOMR.utils.mark("init:plugins:end");BOOMR.utils.measure("init:plugins","init:plugins:start","init:plugins:end");for(i=0;i<properties.length;i+=1){if(config[properties[i]]!==undefined){impl[properties[i]]=config[properties[i]]}}if((!impl.handlers_attached&&!config.wait)||(impl.handlers_attached&&impl.waiting_for_config)){if(!impl.onloadfired&&(impl.autorun===undefined||impl.autorun!==false)){if(BOOMR.hasBrowserOnloadFired()){BOOMR.loadedLate=true}BOOMR.attach_page_ready(BOOMR.page_ready_autorun)}impl.waiting_for_config=false}if(impl.handlers_attached){return this}if(config.wait){impl.waiting_for_config=true}BOOMR.attach_page_ready(function(){if(!BOOMR.t_onload){BOOMR.t_onload=BOOMR.now()}});BOOMR.utils.addListener(w,"DOMContentLoaded",function(){impl.fireEvent("dom_loaded")});BOOMR.fireEvent("config",config);BOOMR.subscribe("config",function(beaconConfig){if(beaconConfig.beacon_url){impl.beacon_url=beaconConfig.beacon_url}});BOOMR.subscribe("spa_navigation",impl.spaNavigation,null,impl);(function(){var forms,iterator;if(visibilityChange!==undefined){BOOMR.utils.addListener(d,visibilityChange,function(){impl.fireEvent("visibility_changed")});impl.lastVisibilityState=BOOMR.visibilityState();BOOMR.subscribe("visibility_changed",function(){var visState=BOOMR.visibilityState();BOOMR.lastVisibilityEvent[visState]=BOOMR.now();BOOMR.debug("Visibility changed from "+impl.lastVisibilityState+" to "+visState);if(impl.lastVisibilityState==="prerender"&&visState!=="prerender"){BOOMR.addVar("vis.pre","1");impl.fireEvent("prerender_to_visible")}impl.lastVisibilityState=visState})}BOOMR.utils.addListener(d,"mouseup",impl.xb_handler("click"));forms=d.getElementsByTagName("form");for(iterator=0;iterator<forms.length;iterator+=1){BOOMR.utils.addListener(forms[iterator],"submit",impl.xb_handler("form_submit"))}if(!w.onpagehide&&w.onpagehide!==null){BOOMR.utils.addListener(w,"unload",function(){BOOMR.window=w=null})}if(BOOMR.boomerang_frame!==BOOMR.window){BOOMR.utils.addListener(BOOMR.boomerang_frame,"unload",impl.onFrameUnloaded)}}());impl.handlers_attached=true;return this},attach_page_ready:function(cb){if(BOOMR.hasBrowserOnloadFired()){this.setImmediate(cb,null,null,BOOMR)}else{if(w.onpagehide||w.onpagehide===null){BOOMR.utils.addListener(w,"pageshow",cb)}else{BOOMR.utils.addListener(w,"load",cb)}}},page_ready_autorun:function(ev){if(impl.autorun){BOOMR.page_ready(ev,true)}},page_ready:function(ev,auto){var tm_page_ready;if(!auto&&typeof ev==="number"){tm_page_ready=ev;ev=null}if(!ev){ev=w.event}if(!ev){ev={name:"load"}}if(!auto){ev.timing=ev.timing||{};if(tm_page_ready){ev.timing.loadEventEnd=tm_page_ready}else if(typeof w.BOOMR_page_ready==="number"){ev.timing.loadEventEnd=w.BOOMR_page_ready}else{ev.timing.loadEventEnd=BOOMR.now()}BOOMR.addVar("pr",1,true)}else if(typeof w.BOOMR_page_ready==="number"){ev.timing=ev.timing||{};ev.timing.loadEventEnd=w.BOOMR_page_ready;BOOMR.addVar("pr",1,true)}if(impl.onloadfired){return this}impl.fireEvent("page_ready",ev);impl.onloadfired=true;return this},hasBrowserOnloadFired:function(){var p=BOOMR.getPerformance();return((d.readyState&&d.readyState==="complete")||(p&&p.timing&&p.timing.loadEventStart>0)||w.BOOMR_onload>0)},onloadFired:function(){return impl.onloadfired},setImmediate:function(fn,data,cb_data,cb_scope){var cb,cstack;if(typeof Error!=="undefined"){cstack=new Error();cstack=cstack.stack?cstack.stack.replace(/^Error/,"Called"):undefined}cb=function(){fn.call(cb_scope||null,data,cb_data||{},cstack);cb=null};if(w.requestIdleCallback){w.requestIdleCallback(cb,{timeout:1000})}else if(w.setImmediate){w.setImmediate(cb)}else{setTimeout(cb,10)}},now:(function(){return Date.now||function(){return new Date().getTime()}}()),getPerformance:function(){try{if(BOOMR.window){if("performance"in BOOMR.window&&BOOMR.window.performance){return BOOMR.window.performance}return BOOMR.window.msPerformance||BOOMR.window.webkitPerformance||BOOMR.window.mozPerformance}}catch(ignore){}},hrNow:function(){var now,navigationStart,p=BOOMR.getPerformance();if(p&&p.now){now=p.now()}else{navigationStart=(BOOMR.plugins.RT&&BOOMR.plugins.RT.navigationStart&&BOOMR.plugins.RT.navigationStart())||BOOMR.t_lstart||BOOMR.t_start;now=BOOMR.now()-navigationStart}return now},visibilityState:(visibilityState===undefined?function(){return "visible"}:function(){return d[visibilityState]}),lastVisibilityEvent:{},registerEvent:function(e_name){if(impl.events.hasOwnProperty(e_name)){return this}impl.events[e_name]=[];return this},disable:function(){impl.clearEvents();impl.clearListeners()},fireEvent:function(e_name,data){return impl.fireEvent(e_name,data)},subscribe:function(e_name,fn,cb_data,cb_scope,once){var i,handler,ev;e_name=e_name.toLowerCase();BOOMR.utils.mark("subscribe");BOOMR.utils.mark("subscribe:"+e_name);if(impl.translate_events[e_name]){e_name=impl.translate_events[e_name]}if(!impl.events.hasOwnProperty(e_name)){impl.events[e_name]=[]}ev=impl.events[e_name];for(i=0;i<ev.length;i+=1){handler=ev[i];if(handler&&handler.fn===fn&&handler.cb_data===cb_data&&handler.scope===cb_scope){return this}}ev.push({fn:fn,cb_data:cb_data||{},scope:cb_scope||null,once:once||false});if(e_name==="page_ready"&&impl.onloadfired&&impl.autorun){this.setImmediate(fn,null,cb_data,cb_scope)}if(e_name==="page_unload"||e_name==="before_unload"){impl.unloadEventsCount+=1;(function(){var unload_handler,evt_idx=ev.length;unload_handler=function(evt){if(fn){fn.call(cb_scope,evt||w.event,cb_data)}if(++impl.unloadEventCalled===impl.unloadEventsCount){BOOMR.real_sendBeacon()}};if(e_name==="page_unload"){if(w.onpagehide||w.onpagehide===null){BOOMR.utils.addListener(w,"pagehide",unload_handler)}else{BOOMR.utils.addListener(w,"unload",unload_handler)}}BOOMR.utils.addListener(w,"beforeunload",unload_handler)}())}return this},addError:function BOOMR_addError(err,src,extra){var str,E=BOOMR.plugins.Errors;BOOMR.utils.mark("add_error");BOOMR.error("Boomerang caught error: "+err+", src: "+src+", extra: "+extra);if(E&&E.is_supported()){if(typeof err==="string"){E.send({message:err,extra:extra,functionName:src,noStack:true},E.VIA_APP,E.SOURCE_BOOMERANG)}else{if(typeof src==="string"){err.functionName=src}if(typeof extra!=="undefined"){err.extra=extra}E.send(err,E.VIA_APP,E.SOURCE_BOOMERANG)}return}if(typeof err!=="string"){str=String(err);if(str.match(/^\[object/)){str=err.name+": "+(err.description||err.message).replace(/\r\n$/,"")}err=str}if(src!==undefined){err="["+src+":"+BOOMR.now()+"] "+err}if(extra){err+=":: "+extra}if(impl.errors[err]){impl.errors[err]+=1}else{impl.errors[err]=1}},isCrossOriginError:function(err){return err.name==="SecurityError"||(err.name==="TypeError"&&err.message==="Permission denied")||(err.name==="Error"&&err.message&&err.message.match(/^(Permission|Access is) denied/))||err.number===-2146828218;},addVar:function(name,value,singleBeacon){BOOMR.utils.mark("add_var");if(typeof name==="string"){impl.vars[name]=value}else if(typeof name==="object"){var o=name,k;for(k in o){if(o.hasOwnProperty(k)){impl.vars[k]=o[k]}}}if(singleBeacon){impl.singleBeaconVars[name]=1}return this},appendVar:function(name,value){var existing=BOOMR.getVar(name)||"";if(existing){existing+=","}BOOMR.addVar(name,existing+value);return this},removeVar:function(arg0){var i,params;if(!arguments.length){return this}if(arguments.length===1&&BOOMR.utils.isArray(arg0)){params=arg0}else{params=arguments}for(i=0;i<params.length;i+=1){if(impl.vars.hasOwnProperty(params[i])){delete impl.vars[params[i]]}}return this},hasVar:function(name){return impl.vars.hasOwnProperty(name)},getVar:function(name){return impl.vars[name]},setVarPriority:function(name,pri){if(typeof pri!=="number"||Math.abs(pri)!==1){return this}impl.varPriority[pri][name]=1;return this},setReferrer:function(r){impl.r=r},requestStart:function(name){var t_start=BOOMR.now();BOOMR.plugins.RT.startTimer("xhr_"+name,t_start);return{loaded:function(data){BOOMR.responseEnd(name,t_start,data)}}},readyToSend:function(){var plugin;for(plugin in this.plugins){if(this.plugins.hasOwnProperty(plugin)){if(impl.disabled_plugins[plugin]){continue}if(typeof this.plugins[plugin].readyToSend==="function"&&this.plugins[plugin].readyToSend()===false){BOOMR.debug("Plugin "+plugin+" is not ready to send");return false}}}return true},responseEnd:function(name,t_start,data,t_end){t_start=typeof t_start==="number"?t_start:BOOMR.now();t_end=typeof t_end==="number"?t_end:BOOMR.now();if(!BOOMR.readyToSend()){BOOMR.debug("Attempted to call responseEnd before all plugins were Ready to Send, trying again...");setTimeout(function(){BOOMR.responseEnd(name,t_start,data,t_end)},1000);return}if(!BOOMR.hasSentPageLoadBeacon()&&!BOOMR.utils.inArray(name.initiator,BOOMR.constants.BEACON_TYPE_SPAS)){BOOMR.subscribe("page_load_beacon",function(){BOOMR.responseEnd(name,t_start,data,t_end)},null,BOOMR,true);return}if(impl.beaconInQueue){BOOMR.subscribe("beacon",function(){BOOMR.responseEnd(name,t_start,data,t_end)},null,BOOMR,true);return}impl.beaconInQueue=true;if(typeof name==="object"){if(!name.url){BOOMR.debug("BOOMR.responseEnd: First argument must have a url property if it's an object");return}impl.fireEvent("xhr_load",name)}else{BOOMR.real_sendBeacon();BOOMR.addVar("xhr.pg",name);BOOMR.plugins.RT.startTimer("xhr_"+name,t_start);impl.fireEvent("xhr_load",{name:"xhr_"+name,data:data,timing:{loadEventEnd:t_end}})}},uninstrumentXHR:function(){},instrumentXHR:function(){},uninstrumentFetch:function(){},instrumentFetch:function(){},sendBeacon:function(beacon_url_override){if(beacon_url_override){impl.beacon_url_override=beacon_url_override}if(!impl.beaconQueued){impl.beaconQueued=true;BOOMR.setImmediate(BOOMR.real_sendBeacon,null,null,BOOMR)}return true},sendBeaconWhenReady:function(params,callback,that){if(impl.beaconInQueue){BOOMR.subscribe("beacon",function(){BOOMR.sendBeaconWhenReady(params,callback,that)},null,BOOMR,true);return}impl.beaconInQueue=true;for(var paramName in params){if(params.hasOwnProperty(paramName)){BOOMR.addVar(paramName,params[paramName],true)}}if(typeof callback==="function"&&typeof that!=="undefined"){callback.apply(that)}BOOMR.sendBeacon()},real_sendBeacon:function(){var k,form,url,errors=[],params=[],paramsJoined,varsSent={},_if;if(!impl.beaconQueued){return false}BOOMR.utils.mark("send_beacon:start");impl.beaconQueued=false;BOOMR.debug("Checking if we can send beacon");for(k in this.plugins){if(this.plugins.hasOwnProperty(k)){if(impl.disabled_plugins[k]){continue}if(!this.plugins[k].is_complete(impl.vars)){BOOMR.debug("Plugin "+k+" is not complete, deferring beacon send");return false}}}if(!window||!window.Image||!window.navigator||!BOOMR.window){BOOMR.debug("DOM not fully available, not sending a beacon");return false}var isSPA=BOOMR.utils.inArray(impl.vars["http.initiator"],BOOMR.constants.BEACON_TYPE_SPAS);var isPageLoad=typeof impl.vars["http.initiator"]==="undefined"||isSPA;if(!impl.vars.pgu){impl.vars.pgu=isSPA?d.URL:d.URL.replace(/#.*/,"")}impl.vars.pgu=BOOMR.utils.cleanupURL(impl.vars.pgu);if(!impl.vars.u||isSPA){impl.vars.u=impl.vars.pgu}if(impl.vars.pgu===impl.vars.u){delete impl.vars.pgu}if(impl.r){impl.vars.r=BOOMR.utils.cleanupURL(impl.r)}else{delete impl.vars.r}impl.vars.v=BOOMR.version;if(BOOMR.snippetVersion){impl.vars.sv=BOOMR.snippetVersion}impl.vars.sm=BOOMR.snippetMethod||"i";if(BOOMR.session.enabled){impl.vars["rt.si"]=BOOMR.session.ID+"-"+Math.round(BOOMR.session.start/1000).toString(36);impl.vars["rt.ss"]=BOOMR.session.start;impl.vars["rt.sl"]=BOOMR.session.length}if(BOOMR.visibilityState()){impl.vars["vis.st"]=BOOMR.visibilityState();if(BOOMR.lastVisibilityEvent.visible){impl.vars["vis.lv"]=BOOMR.now()-BOOMR.lastVisibilityEvent.visible}if(BOOMR.lastVisibilityEvent.hidden){impl.vars["vis.lh"]=BOOMR.now()-BOOMR.lastVisibilityEvent.hidden}}impl.vars["ua.plt"]=navigator.platform;impl.vars["ua.vnd"]=navigator.vendor;if(this.pageId){impl.vars.pid=this.pageId}impl.vars.n= ++this.beaconsSent;if(w!==window){_if="if";impl.vars[_if]=""}for(k in impl.errors){if(impl.errors.hasOwnProperty(k)){errors.push(k+(impl.errors[k]>1?" (*"+impl.errors[k]+")":""))}}if(errors.length>0){impl.vars.errors=errors.join("\n")}impl.errors={};impl.fireEvent("before_beacon",impl.vars);for(k in impl.vars){if(impl.vars.hasOwnProperty(k)){varsSent[k]=impl.vars[k]}}BOOMR.removeVar(["qt","pgu"]);for(var singleVarName in impl.singleBeaconVars){if(impl.singleBeaconVars.hasOwnProperty(singleVarName)){BOOMR.removeVar(singleVarName)}}impl.singleBeaconVars={};if(!impl.hasSentPageLoadBeacon&&isPageLoad){impl.hasSentPageLoadBeacon=true;BOOMR.setImmediate(function(){impl.fireEvent("page_load_beacon",varsSent)})}if(BOOMR.session.rate_limited){BOOMR.debug("Skipping because we're rate limited");return false}impl.beaconInQueue=false;BOOMR.sendBeaconData(varsSent);BOOMR.utils.mark("send_beacon:end");BOOMR.utils.measure("send_beacon","send_beacon:start","send_beacon:end");return true},hasSentPageLoadBeacon:function(){return impl.hasSentPageLoadBeacon},sendBeaconData:function(data){var urlFirst=[],urlLast=[],params,paramsJoined,url,img,useImg=true,xhr,ret;BOOMR.debug("Ready to send beacon: "+BOOMR.utils.objectToString(data));impl.beacon_url=impl.beacon_url_override||impl.beacon_url;if(!impl.beacon_url){BOOMR.debug("No beacon URL, so skipping.");return false}if(!impl.beaconUrlAllowed(impl.beacon_url)){BOOMR.debug("Beacon URL not allowed: "+impl.beacon_url);return false}if(data.length===0){return false}impl.fireEvent("beacon",data);urlFirst=this.getVarsOfPriority(data,-1);urlLast=this.getVarsOfPriority(data,1);params=urlFirst.concat(this.getVarsOfPriority(data,0),urlLast);paramsJoined=params.join("&");if(impl.beacon_url_force_https&&impl.beacon_url.match(/^\/\//)){impl.beacon_url="https:"+impl.beacon_url}url=impl.beacon_url+((impl.beacon_url.indexOf("?")>-1)?"&":"?")+paramsJoined;if(impl.beacon_type==="GET"){useImg=true;if(url.length>BOOMR.constants.MAX_GET_LENGTH){((window.console&&(console.warn||console.log))||function(){})("Boomerang: Warning: Beacon may not be sent via GET due to payload size > 2000 bytes")}}else if(impl.beacon_type==="POST"||url.length>BOOMR.constants.MAX_GET_LENGTH){useImg=false}if(w&&w.navigator&&typeof w.navigator.sendBeacon==="function"&&BOOMR.utils.isNative(w.navigator.sendBeacon)&&typeof w.Blob==="function"&&impl.beacon_type!=="GET"&&typeof impl.beacon_auth_token==="undefined"&&!impl.beacon_disable_sendbeacon){var blobData=new w.Blob([paramsJoined+"&sb=1"],{type:"application/x-www-form-urlencoded"});if(w.navigator.sendBeacon(impl.beacon_url,blobData)){return true}}if(!BOOMR.orig_XMLHttpRequest&&(!w||!w.XMLHttpRequest)){useImg=true}if(useImg){try{img=new Image()}catch(e){BOOMR.debug("Image is not a constructor, not sending a beacon");return false}img.src=url}else{xhr=new(BOOMR.window.orig_XMLHttpRequest||BOOMR.orig_XMLHttpRequest||BOOMR.window.XMLHttpRequest)();try{this.sendXhrPostBeacon(xhr,paramsJoined)}catch(e){xhr=new BOOMR.boomerang_frame.XMLHttpRequest();this.sendXhrPostBeacon(xhr,paramsJoined)}}return true},hasSentPageLoadBeacon:function(){return impl.hasSentPageLoadBeacon},sendXhrPostBeacon:function(xhr,paramsJoined){xhr.open("POST",impl.beacon_url);xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");if(typeof impl.beacon_auth_token!=="undefined"){if(typeof impl.beacon_auth_key==="undefined"){impl.beacon_auth_key="Authorization"}xhr.setRequestHeader(impl.beacon_auth_key,impl.beacon_auth_token)}if(impl.beacon_with_credentials){xhr.withCredentials=true}xhr.send(paramsJoined)},getVarsOfPriority:function(vars,pri){var name,url=[],iterVars=(pri!==0?impl.varPriority[pri]:vars);for(name in iterVars){if(iterVars.hasOwnProperty(name)&&vars.hasOwnProperty(name)){url.push(this.getUriEncodedVar(name,typeof vars[name]==="undefined"?"":vars[name]));if(pri!==0){delete vars[name]}}}return url},getUriEncodedVar:function(name,value){if(value===undefined||value===null){value=""}if(typeof value==="object"){value=BOOMR.utils.serializeForUrl(value)}var result=encodeURIComponent(name)+"="+encodeURIComponent(value);return result},getResourceTiming:function(url,sort,filter){var entries,p=BOOMR.getPerformance();try{if(p&&typeof p.getEntriesByName==="function"){entries=p.getEntriesByName(url);if(!entries||!entries.length){return}if(typeof filter==="function"){entries=BOOMR.utils.arrayFilter(entries,filter);if(!entries||!entries.length){return}}if(entries.length>1&&typeof sort==="function"){entries.sort(sort)}return entries[entries.length-1]}}catch(e){BOOMR.warn("getResourceTiming:"+e)}},setBeaconUrlsAllowed:function(urls){impl.beacon_urls_allowed=urls}};if(!BOOMR.url){boomr.url=boomr.utils.getMyURL()}else{var a=BOOMR.window.document.createElement("a");a.href=BOOMR.url;boomr.url=a.href}delete BOOMR_start;if(typeof BOOMR_lstart==="number"){boomr.t_lstart=BOOMR_lstart;delete BOOMR_lstart}else if(typeof BOOMR.window.BOOMR_lstart==="number"){boomr.t_lstart=BOOMR.window.BOOMR_lstart}if(typeof BOOMR.window.BOOMR_onload==="number"){boomr.t_onload=BOOMR.window.BOOMR_onload}(function(){var make_logger;if(typeof console==="object"&&console.log!==undefined){boomr.log=function(m,l,s){console.log("("+BOOMR.now()+") {"+BOOMR.pageId+"}: "+s+": ["+l+"] "+m)}}else{boomr.log=function(){}}make_logger=function(l){return function(m,s){this.log(m,l,"boomerang"+(s?"."+s:""));return this}};boomr.debug=make_logger("debug");boomr.info=make_logger("info");boomr.warn=make_logger("warn");boomr.error=make_logger("error")}());try{var p=boomr.getPerformance();if(p&&typeof p.now==="function"&&/\[native code\]/.test(String(p.now))&&p.timing&&p.timing.navigationStart){boomr.now=function(){return Math.round(p.now()+p.timing.navigationStart)}}}catch(ignore){}impl.checkLocalStorageSupport();(function(){var ident;for(ident in boomr){if(boomr.hasOwnProperty(ident)){BOOMR[ident]=boomr[ident]}}if(!BOOMR.xhr_excludes){BOOMR.xhr_excludes={}}}());(function(){BOOMR.checkWindowOverrides=function(win){if(!Object.getOwnPropertyNames){return[]}var freshWindow,objects,overridden=[];function setup(){var iframe=d.createElement("iframe");iframe.style.display="none";iframe.src="javascript:false";d.getElementsByTagName("script")[0].parentNode.appendChild(iframe);freshWindow=iframe.contentWindow;objects=Object.getOwnPropertyNames(freshWindow)}function teardown(){iframe.parentNode.removeChild(iframe)}function checkWindowObject(objectKey){if(isNonNative(objectKey)){overridden.push(objectKey)}}function isNonNative(key){var split=key.split("."),fn=win,results=[];while(fn&&split.length){try{fn=fn[split.shift()]}catch(e){return false}}return typeof fn==="function"&&!isNativeFunction(fn,key)}function isNativeFunction(fn,str){if(str==="console.assert"||str==="Function.prototype"||str.indexOf("onload")>=0||str.indexOf("onbeforeunload")>=0||str.indexOf("onerror")>=0||str.indexOf("onload")>=0||str.indexOf("NodeFilter")>=0){return true}return fn.toString&&!fn.hasOwnProperty("toString")&&/\[native code\]/.test(String(fn))}setup();for(var objectIndex=0;objectIndex<objects.length;objectIndex+=1){var objectKey=objects[objectIndex];if(objectKey==="window"||objectKey==="self"||objectKey==="top"||objectKey==="parent"||objectKey==="frames"){continue}if(freshWindow[objectKey]&&(typeof freshWindow[objectKey]==="object"||typeof freshWindow[objectKey]==="function")){checkWindowObject(objectKey);var propertyNames=[];try{propertyNames=Object.getOwnPropertyNames(freshWindow[objectKey])}catch(e){}for(var i=0;i<propertyNames.length;i+=1){checkWindowObject([objectKey,propertyNames[i]].join("."))}if(freshWindow[objectKey].prototype){propertyNames=Object.getOwnPropertyNames(freshWindow[objectKey].prototype);for(var i=0;i<propertyNames.length;i+=1){checkWindowObject([objectKey,"prototype",propertyNames[i]].join("."))}}}}return overridden};BOOMR.checkDocumentOverrides=function(doc){return BOOMR.utils.arrayFilter(["readyState","domain","hidden","URL","cookie"],function(key){return doc.hasOwnProperty(key)})};if(BOOMR.utils.getQueryParamValue("overridden")==="true"&&w&&w.Object&&Object.getOwnPropertyNames){var overridden=[].concat(BOOMR.checkWindowOverrides(w)).concat(BOOMR.checkDocumentOverrides(d));if(overridden.length>0){BOOMR.warn("overridden: "+overridden.sort())}}})();dispatchEvent("onBoomerangLoaded",{"BOOMR":BOOMR},true)}(window));